{% extends "base.html" %}

{% block title %}Document Checklists - CRM{% endblock %}

{% block content %}
<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
    <h1 class="h2">Document Checklists</h1>
    <div class="btn-toolbar mb-2 mb-md-0">
        <div class="btn-group me-2">
            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#newChecklistModal">
                <i class="fas fa-plus me-1"></i>Create Checklist
            </button>
        </div>
    </div>
</div>

<div class="row mb-4">
    <div class="col-md-3">
        <div class="card text-center">
            <div class="card-body">
                <h5 class="card-title text-primary">Active Checklists</h5>
                <h2 class="display-4">18</h2>
                <small class="text-muted">In Progress</small>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-center">
            <div class="card-body">
                <h5 class="card-title text-success">Completed</h5>
                <h2 class="display-4">42</h2>
                <small class="text-muted">This Month</small>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-center">
            <div class="card-body">
                <h5 class="card-title text-warning">Overdue</h5>
                <h2 class="display-4">5</h2>
                <small class="text-muted">Past Due Date</small>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-center">
            <div class="card-body">
                <h5 class="card-title text-info">Avg Completion</h5>
                <h2 class="display-4">87%</h2>
                <small class="text-muted">Document Rate</small>
            </div>
        </div>
    </div>
</div>

<div class="card">
    <div class="card-header">
        <div class="row align-items-center">
            <div class="col">
                <h5 class="card-title mb-0">
                    <i class="fas fa-list-check me-2"></i>Client Document Checklists
                </h5>
            </div>
            <div class="col-auto">
                <div class="input-group">
                    <select class="form-select form-select-sm">
                        <option>All Services</option>
                        <option>ITR Filing</option>
                        <option>GST Returns</option>
                        <option>Audit</option>
                        <option>ROC Compliance</option>
                    </select>
                </div>
            </div>
        </div>
    </div>
    <div class="card-body">
        <div class="table-responsive">
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>Client</th>
                        <th>Service Type</th>
                        <th>Due Date</th>
                        <th>Progress</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>
                            <strong>ABC Company Ltd</strong><br>
                            <small class="text-muted">ITR-6 Filing AY 2023-24</small>
                        </td>
                        <td><span class="badge bg-primary">ITR Filing</span></td>
                        <td>30-09-2024</td>
                        <td>
                            <div class="progress" style="height: 20px;">
                                <div class="progress-bar bg-success" style="width: 85%">85%</div>
                            </div>
                            <small class="text-muted">17/20 documents received</small>
                        </td>
                        <td><span class="badge bg-warning">In Progress</span></td>
                        <td>
                            <div class="btn-group btn-group-sm">
                                <button class="btn btn-outline-primary btn-sm" title="View Details">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="btn btn-outline-success btn-sm" title="Mark Complete">
                                    <i class="fas fa-check"></i>
                                </button>
                                <button class="btn btn-outline-info btn-sm" title="Send Reminder">
                                    <i class="fas fa-bell"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <strong>XYZ Pvt Ltd</strong><br>
                            <small class="text-muted">Statutory Audit FY 2023-24</small>
                        </td>
                        <td><span class="badge bg-info">Audit</span></td>
                        <td>15-08-2024</td>
                        <td>
                            <div class="progress" style="height: 20px;">
                                <div class="progress-bar bg-success" style="width: 100%">100%</div>
                            </div>
                            <small class="text-muted">25/25 documents received</small>
                        </td>
                        <td><span class="badge bg-success">Complete</span></td>
                        <td>
                            <div class="btn-group btn-group-sm">
                                <button class="btn btn-outline-primary btn-sm" title="View Details">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="btn btn-outline-secondary btn-sm" title="Download Report">
                                    <i class="fas fa-download"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <strong>DEF Industries</strong><br>
                            <small class="text-muted">GST Annual Return GSTR-9</small>
                        </td>
                        <td><span class="badge bg-warning">GST Returns</span></td>
                        <td class="text-danger">31-12-2024</td>
                        <td>
                            <div class="progress" style="height: 20px;">
                                <div class="progress-bar bg-warning" style="width: 60%">60%</div>
                            </div>
                            <small class="text-muted">9/15 documents received</small>
                        </td>
                        <td><span class="badge bg-warning">In Progress</span></td>
                        <td>
                            <div class="btn-group btn-group-sm">
                                <button class="btn btn-outline-primary btn-sm" title="View Details">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="btn btn-outline-danger btn-sm" title="Follow Up">
                                    <i class="fas fa-exclamation-triangle"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <strong>PQR Corp</strong><br>
                            <small class="text-muted">ROC Annual Filing</small>
                        </td>
                        <td><span class="badge bg-success">ROC Compliance</span></td>
                        <td>30-09-2024</td>
                        <td>
                            <div class="progress" style="height: 20px;">
                                <div class="progress-bar bg-danger" style="width: 30%">30%</div>
                            </div>
                            <small class="text-muted">6/20 documents received</small>
                        </td>
                        <td><span class="badge bg-danger">Overdue</span></td>
                        <td>
                            <div class="btn-group btn-group-sm">
                                <button class="btn btn-outline-primary btn-sm" title="View Details">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="btn btn-outline-danger btn-sm" title="Urgent Follow Up">
                                    <i class="fas fa-phone"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<!-- New Checklist Modal -->
<div class="modal fade" id="newChecklistModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Create Document Checklist</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Client</label>
                                <select class="form-select" required>
                                    <option value="">Select Client</option>
                                    <option>ABC Company Ltd</option>
                                    <option>XYZ Pvt Ltd</option>
                                    <option>DEF Industries</option>
                                    <option>PQR Corp</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Service Type</label>
                                <select class="form-select" id="serviceType" required>
                                    <option value="">Select Service</option>
                                    <option value="itr">ITR Filing</option>
                                    <option value="gst">GST Returns</option>
                                    <option value="audit">Statutory Audit</option>
                                    <option value="roc">ROC Compliance</option>
                                    <option value="custom">Custom Checklist</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Checklist Name</label>
                                <input type="text" class="form-control" placeholder="e.g., ITR-6 Filing AY 2023-24" required>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Due Date</label>
                                <input type="date" class="form-control" required>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">Required Documents</label>
                        <div id="documentList">
                            <!-- Documents will be populated based on service type -->
                        </div>
                        <button type="button" class="btn btn-outline-primary btn-sm mt-2" onclick="addCustomDocument()">
                            <i class="fas fa-plus me-1"></i>Add Custom Document
                        </button>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary">Create Checklist</button>
            </div>
        </div>
    </div>
</div>

<!-- Document Templates -->
<div id="documentTemplates" style="display: none;">
    <div class="itr-documents">
        <div class="form-check"><input class="form-check-input" type="checkbox" checked><label class="form-check-label">Form 16/16A</label></div>
        <div class="form-check"><input class="form-check-input" type="checkbox" checked><label class="form-check-label">Bank Statements</label></div>
        <div class="form-check"><input class="form-check-input" type="checkbox" checked><label class="form-check-label">Investment Proofs (80C)</label></div>
        <div class="form-check"><input class="form-check-input" type="checkbox" checked><label class="form-check-label">House Rent Receipts</label></div>
        <div class="form-check"><input class="form-check-input" type="checkbox" checked><label class="form-check-label">Capital Gains Statements</label></div>
        <div class="form-check"><input class="form-check-input" type="checkbox" checked><label class="form-check-label">Interest Certificates</label></div>
    </div>
    
    <div class="audit-documents">
        <div class="form-check"><input class="form-check-input" type="checkbox" checked><label class="form-check-label">Trial Balance</label></div>
        <div class="form-check"><input class="form-check-input" type="checkbox" checked><label class="form-check-label">Ledger Accounts</label></div>
        <div class="form-check"><input class="form-check-input" type="checkbox" checked><label class="form-check-label">Bank Reconciliation</label></div>
        <div class="form-check"><input class="form-check-input" type="checkbox" checked><label class="form-check-label">Fixed Asset Register</label></div>
        <div class="form-check"><input class="form-check-input" type="checkbox" checked><label class="form-check-label">Stock Statements</label></div>
        <div class="form-check"><input class="form-check-input" type="checkbox" checked><label class="form-check-label">Debtors/Creditors Aging</label></div>
    </div>
    
    <div class="gst-documents">
        <div class="form-check"><input class="form-check-input" type="checkbox" checked><label class="form-check-label">GSTR-1 Returns</label></div>
        <div class="form-check"><input class="form-check-input" type="checkbox" checked><label class="form-check-label">GSTR-3B Returns</label></div>
        <div class="form-check"><input class="form-check-input" type="checkbox" checked><label class="form-check-label">Purchase Register</label></div>
        <div class="form-check"><input class="form-check-input" type="checkbox" checked><label class="form-check-label">Sales Register</label></div>
        <div class="form-check"><input class="form-check-input" type="checkbox" checked><label class="form-check-label">Input Tax Credit Details</label></div>
    </div>
    
    <div class="roc-documents">
        <div class="form-check"><input class="form-check-input" type="checkbox" checked><label class="form-check-label">Balance Sheet</label></div>
        <div class="form-check"><input class="form-check-input" type="checkbox" checked><label class="form-check-label">Profit & Loss Account</label></div>
        <div class="form-check"><input class="form-check-input" type="checkbox" checked><label class="form-check-label">Director's Report</label></div>
        <div class="form-check"><input class="form-check-input" type="checkbox" checked><label class="form-check-label">Auditor's Report</label></div>
        <div class="form-check"><input class="form-check-input" type="checkbox" checked><label class="form-check-label">Board Resolutions</label></div>
        <div class="form-check"><input class="form-check-input" type="checkbox" checked><label class="form-check-label">AGM Minutes</label></div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const serviceType = document.getElementById('serviceType');
    const documentList = document.getElementById('documentList');
    const templates = document.getElementById('documentTemplates');
    
    serviceType.addEventListener('change', function() {
        const selectedService = this.value;
        documentList.innerHTML = '';
        
        if (selectedService && selectedService !== 'custom') {
            const templateClass = selectedService + '-documents';
            const template = templates.querySelector('.' + templateClass);
            if (template) {
                documentList.innerHTML = template.innerHTML;
            }
        }
    });
});

function addCustomDocument() {
    const documentList = document.getElementById('documentList');
    const newDoc = document.createElement('div');
    newDoc.className = 'form-check';
    newDoc.innerHTML = `
        <input class="form-check-input" type="checkbox" checked>
        <input type="text" class="form-control form-control-sm d-inline-block" style="width: 70%;" placeholder="Enter document name">
        <button type="button" class="btn btn-sm btn-outline-danger ms-2" onclick="this.parentElement.remove()">
            <i class="fas fa-trash"></i>
        </button>
    `;
    documentList.appendChild(newDoc);
}
</script>
{% endblock %}